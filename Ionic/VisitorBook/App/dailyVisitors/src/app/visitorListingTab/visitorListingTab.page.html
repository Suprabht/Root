<ion-header [translucent]="true">
    <ion-toolbar color="success">
        <ion-buttons>
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Visitors Listings ({{this.userName}})</ion-title>
    </ion-toolbar>
</ion-header>
<ion-content>
    <ion-fab horizontal="end" vertical="top" slot="fixed" edge>
        <ion-fab-button *ngIf="this.detailList.length == 0" color="danger">
            <ion-icon name="hourglass-outline"></ion-icon>
        </ion-fab-button>
        <ion-fab-button *ngIf="this.detailList.length > 0" color="secondary" (click)="refresh()">
            <ion-icon name="sync-outline"></ion-icon>
        </ion-fab-button>
    </ion-fab>
    <ion-card *ngFor ="let detail of this.detailList">
        <ion-card-header>
          <ion-card-subtitle>#{{detail.visitorId}}</ion-card-subtitle>
          <ion-card-title>{{detail.visitorName}}</ion-card-title>
        </ion-card-header>
        <ion-card-content class="visitorDetailCardContent">
            <IonContent class="visitorDetailContent">
                <ion-chip>
                    <ion-icon color="success" name="mail"></ion-icon>
                    <ion-label><a href="mailto:{{detail.email | lowercase}}" style="text-decoration: none; color:#000; cursor: pointer;">{{detail.email | lowercase}}</a></ion-label>
                </ion-chip>
                <ion-chip>
                    <ion-icon color="success" name="call"></ion-icon>
                    <ion-label><a href="tel:{{detail.mobileNumber}}" style="text-decoration: none; color:#000; cursor: pointer;">{{detail.mobileNumber}}</a></ion-label>
                </ion-chip>
                <ion-text color="secondary">
                    <h1>
                        Address
                    </h1>
                </ion-text>
                <ion-icon color="primary" name="home-outline"></ion-icon>
                <ion-text>&nbsp;{{detail.adress}}
                </ion-text><br/><br/>

                <ion-icon color="primary" name="location-outline"></ion-icon>
                <ion-text><strong>&nbsp;Coming From: </strong></ion-text>
                <ion-text>{{detail.fromPlace}}</ion-text><br/>

                <ion-icon color="primary" name="globe-outline"></ion-icon>
                <ion-text><strong>&nbsp;Company: </strong></ion-text>
                <ion-text>{{detail.company}}</ion-text><br/>

                <ion-icon color="primary" name="body-outline"></ion-icon>
                <ion-text ><strong>&nbsp;Person visiting in RWS: </strong></ion-text>
                <ion-text >{{detail.personInSdl}}</ion-text><br/><br/>

                <ion-icon color="primary" name="log-in-outline"></ion-icon>
                <ion-text><strong>&nbsp;Login Date and Time : </strong></ion-text>
                <ion-text>{{detail.loginDateTime | date: "yyyy/MM/dd HH:mm:ss"}}</ion-text><br/>
                <ion-icon color="primary" name="log-out-outline"></ion-icon>
                <ion-text><strong>&nbsp;Logout Date and Time: </strong></ion-text>
                <ion-text *ngIf="detail.logoutDateTime != undefined">{{detail.logoutDateTime | date: "yyyy/MM/dd HH:mm:ss"}}</ion-text>
                <ion-text *ngIf="detail.logoutDateTime == undefined"><italic>Still not logged out</italic></ion-text><br/><br/>

                <ion-button *ngIf="detail.logoutDateTime == undefined" shape="round" color="secondary" (click)="printBadgePDF(detail)">
                    <ion-icon name="print-outline"></ion-icon>
                </ion-button>

                <ion-button *ngIf="detail.logoutDateTime == undefined" shape="round" color="warning" (click) ="logout(detail.visitorId)">
                    <ion-icon name="log-out-outline"></ion-icon>
                </ion-button>

                <ion-button shape="round" color="danger" (click) ="showConfirmAlert(detail.visitorId)">
                    <ion-icon name="trash"></ion-icon>
                </ion-button>
            </IonContent>
        </ion-card-content>
        <ion-card class="photoCard">
            <ion-card-header>
                Photo
            </ion-card-header>
            <ion-card-content>
                <img style="width:260px; height: 180px;" src="{{this.imageUrl}}/{{detail.picture}}" />
            </ion-card-content>
        </ion-card>
        <ion-card class="photoSignature">
            <ion-card-header>
                Signature
            </ion-card-header>
            <ion-card-content>
                <img style="width:260px; height: 180px;" src="{{this.imageUrl}}/{{detail.signature}}" />
            </ion-card-content>
        </ion-card>
    </ion-card>
    <div style="display:none">
        <div id="printDiv">
            <table cellpadding=0 style="font-size:11px; border:#000 solid 2px;">
                <tr>
                  <td style="width:410px; padding: 5px; border-right:#000 solid 2px;">
                    <table cellpadding=0 style="font-size:11px; width:100%">
                        <tr>
                            <td style="width: 50%; height: 40px;">&nbsp;</td>
                            <td style="text-align: right; width: 50%;"><strong>Badge&nbsp;&nbsp;</strong></td>
                        </tr>
                        <tr>
                            <td style="height: 40px;"><strong>Name:- </strong></td>
                            <td>{{this.selectedVisitor.visitorName}}</td>
                        </tr>
                        <tr>
                            <td style="height: 40px;"><strong>Company Name:- </strong></td>
                            <td>{{this.selectedVisitor.company}}</td>
                        </tr>
                        <tr>
                            <td style="height: 40px;"><strong>Person Visiting in RWS:- </strong></td>
                            <td>{{this.selectedVisitor.visitorName}}</td>
                        </tr>
                        <tr>
                            <td style="height: 40px;"><strong>Date:- </strong></td>
                            <td>{{this.selectedVisitor.loginDateTime | date: "yyyy/MM/dd"}}</td>
                        </tr>
                    </table>
                  </td>
                  <td style="width:410px; padding: 5px;">
                    <strong>THROUGHOUT YOUR VISIT YOUR PERSONAL SAFETY IS OUR CONCERN<br/>-WE THERFORE REQUEST THAT YOU ABIDE BY THE FOLLOWING:</strong><br/><br/>
                    <strong>HEALTH & SAFETY -</strong> All visitors are subject to the Health & Safety at Work Act 1974, Management of Health & Safety at work Regulations 1999 and Company Regulations whilst on the premises.<br/>
                    <strong>SMOKING -</strong> Please observe the No Smoking policy.<br/>
                    <strong>FIRE/EMERGENCY -</strong> In the event of an emergency, all visitors must leave the premises immediatly via the nearest safe exit and report to the designated assembly point. Do not re-enter the premises until you are advised it is safe to do so.<br/>
                    <strong>CONTRACTORS -</strong> Must ensure that any necessary Permit to work documenttion is completed before commencing work.
                    <strong>ACCIDENTS/INCIDENTS -</strong> All accidents, injures and near misses must be immediately reported.
                 </td>
                </tr>
            </table>
        </div>
    </div>
</ion-content>