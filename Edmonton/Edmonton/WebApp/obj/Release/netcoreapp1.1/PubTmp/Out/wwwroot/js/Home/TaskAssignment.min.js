TaskAssignment=function(){};TaskAssignment.prototype.init=function(){var u=document.createElement("table"),n,t,r;u.id="grid";$("#gridContainer").append(u);n=document.createElement("div");n.id="gridPager";$("#gridContainer").append(n);t={};r={};$.getJSON("/Home/Client",function(n){for(i=0;i<n.rows.length;i++)t[n.rows[i].clientId]=n.rows[i].clientName+" | "+n.rows[i].clientAddress.substring(0,20);$.getJSON("/Home/GetUsers",function(n){for(i=0;i<n.rows.length;i++)r[n.rows[i].id]=n.rows[i].name+" | "+n.rows[i].email.substring(0,20);$.getJSON("/Home/TaskAssignment",function(n){taskAssignment.loadGrid(n,t,r)})})})};TaskAssignment.prototype.loadGrid=function(n,t,i){var r=$("#grid");r.jqGrid({colModel:[{label:"Assignment Id",name:"assignmentId",index:"assignmentId",width:"110",editable:!1,key:!0,editrules:{required:!0}},{label:"Assignment Date",name:"assignmentDate",index:"assignmentDate",width:"110",editrules:{required:!0},editable:!0,editrules:{required:!0},formatter:"date",formatoptions:{srcformat:"Y/m/d H:i",newformat:"Y/m/d H:i"},editoptions:{dataInit:function(n){$("div").css("position","relative");$(n).datetimepicker({locale:"en-US",widgetPositioning:{horizontal:"auto",vertical:"auto"},widgetParent:"#gridContainer"});$(n).bind("dp.show",function(){var n=$("#gridContainer .bootstrap-datetimepicker-widget");n.length>0&&n.css("top",this.getBoundingClientRect().top+window.pageYOffset+$(this).outerHeight())})}}},{label:"Client",name:"clientName",index:"clientName",width:"110",editable:!0,editrules:{required:!0},edittype:"select",editoptions:{value:t}},{label:"User Id",name:"userName",index:"userName",width:"110",editable:!0,editrules:{required:!0},edittype:"select",editoptions:{value:i}},{label:"Accepted",name:"accept",index:"accept",width:"210",editable:!1,formatter:taskAssignment.accept}],pager:"#gridPager",regional:"en",datatype:"jsonstring",datastr:n,jsonReader:{repeatitems:!1},rowNum:n.records,viewrecords:!0,caption:"Assignment",height:"auto",ignoreCase:!0});r.navGrid("#gridPager",{edit:!0,add:!0,del:!0,search:!1,refresh:!1,view:!1,position:"left",cloneToTop:!1},{url:"/Home/TaskAssignment",editCaption:"The Edit Dialog",recreateForm:!0,checkOnUpdate:!1,checkOnSubmit:!1,closeAfterEdit:!0,reloadAfterSubmit:!0,mtype:"POST",modal:!0,jqModal:!0,serializeEditData:function(n){return{assignmentId:parseInt(n.id),assignmentDate:n.assignmentDate,clientId:n.clientName,userId:n.userName}},afterSubmit:function(){return taskAssignment.unLoadGrid(),taskAssignment.init(),!0},errorTextFormat:function(n){return"Error: "+n.responseText}},{url:"/Home/TaskAssignment",closeAfterAdd:!0,recreateForm:!0,mtype:"PUT",checkOnUpdate:!1,checkOnSubmit:!1,clearAfterAdd:!0,reloadAfterSubmit:!1,afterSubmit:function(){return taskAssignment.unLoadGrid(),taskAssignment.init(),$(".ui-icon-closethick").trigger("click"),!0},errorTextFormat:function(n){return"Error: "+n.responseText}},{url:"/Home/TaskAssignment",mtype:"DELETE",editCaption:"The Edit Dialog",recreateForm:!0,checkOnUpdate:!1,checkOnSubmit:!1,closeAfterDelete:!0,reloadAfterSubmit:!0,modal:!0,jqModal:!0,afterSubmit:function(){return taskAssignment.unLoadGrid(),taskAssignment.init(),$(".ui-icon-closethick").trigger("click"),!0},errorTextFormat:function(n){return"Error: "+n.responseText}})};TaskAssignment.prototype.accept=function(n,t,i){return(i.userName===null||i.userName==="")?'<span class="notAssigned">Not yet Assigned!!<\/span>':i.accept!=="True"?'<button class="notAccept" onClick="javascript:taskAssignment.acceptAssignment('+i.assignmentId+');" target="_blank" > Accept on behalf of employees <\/button>':'<button class="accept" onClick="javascript:taskAssignment.cancelAssignment('+i.assignmentId+');" target="_blank" > Cancell Acceptence <\/button>'};TaskAssignment.prototype.acceptAssignment=function(n){$.getJSON("/Home/AcceptAssignment/"+n,function(){alert("Assignment is update!!");taskAssignment.unLoadGrid();taskAssignment.init()})};TaskAssignment.prototype.cancelAssignment=function(n){$.getJSON("/Home/CancelAssignment/"+n,function(){alert("Assignment is update!!");taskAssignment.unLoadGrid();taskAssignment.init()})};TaskAssignment.prototype.unLoadGrid=function(){$("#grid").jqGrid("clearGridData");$("#grid").remove();$("#gridPager").remove();$("#gridContainer").empty()};var taskAssignment=new TaskAssignment;taskAssignment.init();